<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Pediatric Clerkship Practical Examination</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root { --maxw: 860px; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Arial, sans-serif; color:#0f172a; background:#fff; }
    .wrap { max-width: var(--maxw); margin: 40px auto; padding: 0 20px; }
    h1 { font-size: 1.75rem; margin: 0 0 8px; }
    h2 { font-size: 1.15rem; margin: 24px 0 8px; }
    p  { line-height: 1.55; margin: 10px 0; }
    ul { margin: 8px 0 0 22px; }
    li { margin: 6px 0; }
    .muted { opacity:.8; }
    .btn { display:inline-block; margin-top: 20px; padding: 12px 18px; font-weight:700; border-radius: 10px;
           background:#111827; color:#fff; text-decoration:none; border:1px solid #111827; }
    .btn:focus { outline: 3px solid #60a5fa; outline-offset: 2px; }
    .panel { background:#f8fafc; border:1px solid #e5e7eb; border-radius:12px; padding:18px; }

    /* Timer view */
    .timer-root { display:flex; align-items:center; justify-content:center; height:100vh; text-align:center; }
    .clock { font-size: 64px; font-weight: 800; font-variant-numeric: tabular-nums; }
    .warn { color:#b33; }
    .sub { margin-top: 8px; font-size: .95rem; opacity:.7; }
  </style>
</head>
<body>
  <div class="wrap" id="intro">
    <h1>Welcome to the Pediatric Clerkship Practical Examination!</h1>
    <div class="panel">
      <p>This examination provides a unique opportunity to demonstrate your skills in biomedical knowledge, clinical reasoning, and systems-based thinking as you engage with simulated cases involving undifferentiated pediatric patients.</p>

      <p>You will be presented with prompts containing key details and asked to respond to specific questions. <strong>Please note that all answers are required.</strong> While the system will not prompt you if an answer is left blank, your responses are mandatory in order to proceed through the examination. Ensure that you fill in all required fields before moving forward (unless otherwise specified). The purpose of this summative assessment is to evaluate your ability to synthesize data, interpret findings, and apply critical thinking in clinical decision-making.</p>

      <p>All essential resources, including immunization schedules and pharmacologic references, will be provided to assist you in formulating your responses. While you are welcome to take notes during the assessment, please note that these notes cannot be taken out of the exam room.</p>

      <p>There are a total of <strong>SIX</strong> stations (numbered 1 to 6) in this practical examination. Each station presents a clinical case with associated questions.</p>

      <p>Please note that the last station is designated as the <strong>FINAL STATION</strong> and contains a different set of questions intended to assess additional competencies.</p>

      <h2>Learning Objectives</h2>
      <ul>
        <li>Obtain, synthesize, and interpret comprehensive medical histories for newborns, children, and adolescents in various clinical settings. (Patient Care 1.1, EPA 1)</li>
        <li>Create an assessment, problem list, differential diagnosis, and management plan for common pediatric complaints. (Patient Care 1.2, EPA 2)</li>
        <li>Integrate and adapt knowledge of growth and development to develop individualized pediatric care strategies that address physical, emotional, and psychosocial needs. (Patient Care 1.2)</li>
        <li>Analyze social determinants of health, evaluate their impact on pediatric health outcomes, and formulate a plan to address these needs effectively. (Health Humanities 7.1, Systems Based Practice 6.4)</li>
      </ul>

      <p class="muted">Good luck, and let this be an opportunity to demonstrate the knowledge, skills, and professionalism you have cultivated throughout your clerkship.</p>

      <a id="startBtn" class="btn" href="#">Start Survey</a>
      <p class="muted">You will have <strong>60 minutes</strong> to complete the examination once you start.</p>
    </div>
  </div>

  <!-- Timer view injected here -->
  <div id="timerView" style="display:none;">
    <div class="timer-root">
      <div>
        <div id="clock" class="clock">60:00</div>
        <div id="sub" class="sub">Countdown continues while your survey is open in another tab.</div>
      </div>
    </div>
  </div>

  <script>
    function qs(name){ const m=location.search.match(new RegExp('[?&]'+name+'=([^&]+)')); return m?decodeURIComponent(m[1]):''; }
    function fmt(s){ s=Math.max(0,s|0); const m=Math.floor(s/60), x=s%60; return m+':'+String(x).padStart(2,'0'); }

    const SURVEY_URL = qs('u');           // pass REDCap link with ?u=...
    const TOTAL_MINUTES = 60;
    const startBtn = document.getElementById('startBtn');
    const intro = document.getElementById('intro');
    const timerView = document.getElementById('timerView');
    const clock = document.getElementById('clock');

    let endMs = 0, tickHandle = null;

    function startTimer(){
      endMs = Date.now() + TOTAL_MINUTES*60*1000;
      const WARN = 60;
      function tick(){
        let rem = Math.ceil((endMs - Date.now())/1000);
        if(rem <= 0){ rem = 0; clearInterval(tickHandle); }
        clock.textContent = fmt(rem);
        if(rem <= WARN) clock.classList.add('warn');
      }
      tickHandle = setInterval(tick, 250); tick();
    }

    function launch(){
      // Show timer here (this tab), open survey in a new tab/window
      intro.style.display = 'none';
      timerView.style.display = 'block';
      startTimer();

      const w = window.open(SURVEY_URL, '_blank');
      if(!w){
        // If popup blocked, tell the user to use the button
        document.getElementById('sub').textContent = 'Popup was blocked. Please allow pop-ups and click Start again, or open the survey from the link below.';
        const link = document.createElement('p');
        link.innerHTML = '<a href="'+SURVEY_URL+'">Open survey</a>';
        document.querySelector('.timer-root > div').appendChild(link);
      }
    }

    if (!SURVEY_URL) {
      startBtn.addEventListener('click', (e)=>{ e.preventDefault(); alert('Missing survey URL. Add ?u=... to this page link.'); });
    } else {
      startBtn.addEventListener('click', (e)=>{ e.preventDefault(); launch(); });
    }
  </script>
</body>
</html>


